import{c as T,B as m,V as O,a6 as E,u as K,L as P,D as Q,x as w,y as N,z as _}from"./index-IoJ-2H-o.js";import{j as e}from"./ui-vendor-B17-n605.js";import{a as D}from"./react-vendor-DPOhIiRq.js";import{D as z}from"./DataTable-BL4SQRvr.js";import{u as S}from"./useMutation-Cp5GjrFm.js";import{u as H}from"./usePaginationTable-07dZaguv.js";import{A as M,a as B,b as V,c as I,d as R,e as U,f as Z,g as $}from"./alert-dialog-C_VuFo-A.js";import{u as q}from"./form-vendor-DdiMXTjA.js";import{t as G,F as J}from"./FormRow-BJnnRaVs.js";import{d as W,c as X,S as Y}from"./SecretForm-Cj4ADodY.js";import{u as b}from"./i18n-vendor-TY_g4tCM.js";import{t as A,c as ee}from"./DateTimeHelper-8fem5lKY.js";import{f as C}from"./utils-BBmT1Bs5.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=T("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),te=({onSubmit:l,onCancel:o,isSubmitting:p})=>{const{t:i}=b(),r=q({defaultValues:W,resolver:G(X(i)),mode:"onChange"}),a=s=>{s.stopPropagation(),r.handleSubmit(u=>{l(u),O({title:i("Actions.Hooray"),description:i("ClientSecret.Actions.Added")})})(s)};return e.jsx(J,{...r,children:e.jsxs("form",{onSubmit:a,children:[e.jsx(Y,{form:r}),e.jsxs("div",{className:"flex gap-4 justify-end mt-4",children:[e.jsx(m,{type:"button",onClick:o,children:i("Actions.Cancel")}),e.jsx(m,{type:"submit",disabled:p,children:i("Actions.Save")})]})]})})},ge=({resourceId:l,queryKey:o,getSecrets:p,addSecret:i,deleteSecret:r})=>{var f,j;const{t:a}=b(),{pagination:s,setPagination:u}=H(0,5),[y,c]=D.useState(!1),h=E(),x=K([...o,s],()=>p(l,s.pageIndex,s.pageSize),{keepPreviousData:!0}),g=S(t=>i(l,t),{onSuccess:()=>{h.invalidateQueries(o),c(!1)}}),v=S(t=>r(t),{onSuccess:()=>{h.invalidateQueries(o)}}),L=t=>{const n=ee(t.expiration,t.expirationTime);g.mutate({...t,expiration:t.addExpiration?n:null})},F=[{accessorKey:"type",header:a("Client.Label.SecretType_Label")},{accessorKey:"description",header:a("Client.Label.SecretDescription_Label")},{accessorKey:"expiration",header:a("Client.Label.ClientSecret_ExpirationDate"),cell:({row:t})=>e.jsx("span",{children:t.original.expiration?C(new Date(t.original.expiration),A):null})},{accessorKey:"created",header:a("Client.Label.ClientSecret_Created"),cell:({row:t})=>{var n;return e.jsx("span",{children:C(new Date((n=t.original)==null?void 0:n.created),A)})}},{id:"actions",cell:({row:t})=>{const n=t.original,[k,d]=D.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(m,{onClick:()=>d(!0),type:"button",variant:"destructive",size:"sm",children:a("Actions.Delete")}),e.jsx(M,{open:k,onOpenChange:d,children:e.jsxs(B,{children:[e.jsxs(V,{children:[e.jsx(I,{children:a("Actions.ConfirmDeletion")}),e.jsx(R,{children:a("Secret.Actions.DeleteSecretConfirm")})]}),e.jsxs(U,{children:[e.jsx(Z,{onClick:()=>d(!1),children:a("Actions.Cancel")}),e.jsx($,{variant:"destructive",onClick:()=>{v.mutate(n.id),d(!1)},children:a("Actions.Delete")})]})]})})]})}}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:a("Secret.PageTitle")}),e.jsx(m,{type:"button",onClick:()=>c(!0),children:a("Secret.Actions.Add")})]}),x.isLoading?e.jsx(P,{}):e.jsx(z,{columns:F,data:((f=x.data)==null?void 0:f.items)??[],totalCount:((j=x.data)==null?void 0:j.totalCount)??-1,pagination:s,setPagination:u}),e.jsx(Q,{open:y,onOpenChange:c,children:e.jsxs(w,{className:"sm:max-w-[800px] overflow-auto max-h-[calc(100vh-2rem)]",children:[e.jsx(N,{children:e.jsx(_,{children:a("Secret.Actions.Add")})}),e.jsx(te,{onSubmit:L,onCancel:()=>c(!1),isSubmitting:g.isLoading})]})})]})};export{he as K,ge as S};
