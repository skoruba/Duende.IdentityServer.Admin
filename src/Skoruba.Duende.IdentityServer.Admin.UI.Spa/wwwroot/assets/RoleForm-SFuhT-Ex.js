import{j as e}from"./ui-vendor-B17-n605.js";import{z as T,u as k}from"./form-vendor-DdiMXTjA.js";import{a as q,t as H,F as K}from"./FormRow-CDTEjXNe.js";import{t as g,u as R}from"./i18n-vendor-TY_g4tCM.js";import{B as C,L as Q,V as h,a6 as _,R as D,j as x}from"./index-DVaCOlPw.js";import{u as E}from"./useMutation-B5d3wT4v.js";import{u as U,b as z,c as I,d as P,e as W}from"./RoleService-De3iHEd1.js";import{H as $}from"./Hoorey-DI6EUxZF.js";import{u as N}from"./modalHooks-CXBaxWb4.js";import{a as j}from"./react-vendor-DPOhIiRq.js";import{R as G}from"./RoleDeleteDialog-BeWM8dKe.js";import{T as J,a as X,b as v,c as S}from"./tabs-Brn-M21m.js";import{D as Y}from"./DataTable-CuhqpYks.js";import{u as Z}from"./usePaginationTable-07dZaguv.js";import{C as ee}from"./ClaimsModal-CwUFRZ2i.js";import{D as se}from"./DeleteDialog-DMd7seyE.js";import{C as y}from"./CardWrapper-DDogQ5iA.js";import{T as ae}from"./trash-c4wphaJi.js";import{T as A}from"./tag-BTeEKxZj.js";import{b as te,a as oe}from"./useConfirmUnsavedChanges-C06oKmnn.js";import{I as L}from"./info-xxxE2Amv.js";import{T as ie}from"./trash-2-Fp7mdsHF.js";const le=T.object({name:T.string().min(1,g("Validation.FieldRequired",{field:g("Role.Section.Label.RoleName_Label")}))}),we={name:""},ne=({roleId:a})=>{const{t:s}=R(),{pagination:i,setPagination:l}=Z(0,5),{isOpen:r,openModal:c,closeModal:d}=N(),[b,t]=j.useState(!1),[m,p]=j.useState(null),{data:o,isLoading:f}=U(a,i.pageIndex,i.pageSize),n=z(a),w=I(a),B=u=>{n.mutate(u,{onSuccess:()=>{h({description:s("Claim.Actions.Added"),title:s("Actions.Hooray")}),d()}})},F=u=>{p(u),t(!0)},O=()=>{m!=null&&w.mutate(m,{onSuccess:()=>{h({description:s("Claim.Actions.Deleted"),title:s("Actions.Hooray")}),t(!1),p(null)}})},V=[{accessorKey:"claimType",header:s("Claim.Key")},{accessorKey:"claimValue",header:s("Claim.Value")},{id:"actions",cell:({row:u})=>e.jsx(C,{variant:"ghost",onClick:()=>F(u.original.claimId),className:"text-red-500",children:e.jsx(ae,{className:"h-4 w-4"})})}];return f?e.jsx(Q,{}):e.jsxs(y,{title:s("Role.Tabs.Claims"),description:s("Role.Tabs.ClaimsDescription"),icon:A,children:[e.jsx(C,{onClick:c,className:"mb-4",type:"button",children:s("Claim.Actions.Add")}),e.jsx(Y,{columns:V,data:(o==null?void 0:o.claims)??[],totalCount:(o==null?void 0:o.totalCount)??0,pagination:i,setPagination:l}),e.jsx(ee,{isOpen:r,onClose:d,onSubmit:B}),e.jsx(se,{isAlertOpen:b,setIsAlertOpen:t,title:s("Claim.DeleteConfirmTitle"),message:s("Claim.DeleteConfirmDescription"),handleDelete:O})]})},re=({mode:a})=>{const{t:s}=R();return e.jsxs(y,{title:s("Role.Tabs.Basics"),description:s("Role.Tabs.BasicsDescription"),icon:L,children:[e.jsx(q,{name:"name",label:s("Role.Section.Label.RoleName_Label"),description:s("Role.Section.Label.RoleName_Info"),placeholder:s("Role.Section.Label.RoleName_Label"),type:"input",required:!0,includeSeparator:!0}),e.jsx(C,{type:"submit",className:"mt-4",children:a===M.Create?s("Actions.Create"):s("Actions.Save")})]})};var M=(a=>(a.Create="create",a.Edit="edit",a))(M||{});const Be=({mode:a,roleId:s,defaultValues:i})=>{const{t:l}=R(),r=_(),c=N(),[d,b]=j.useState("basics"),t=k({resolver:H(le),defaultValues:i}),m=te(t),{DialogCmp:p}=oe(t.formState.isDirty),o=E(n=>a==="create"?P(n):W(s,n),{onSuccess:()=>{r.invalidateQueries(x.roles),r.invalidateQueries(x.role),r.invalidateQueries(x.roleClaims),h({title:e.jsx($,{}),description:l(a==="create"?"Role.Actions.Created":"Role.Actions.Updated")}),m(D)}}),f=a==="edit"&&!!s&&!!i.name;return e.jsxs(e.Fragment,{children:[e.jsxs(K,{...t,children:[e.jsx("form",{onSubmit:t.handleSubmit(n=>o.mutate(n)),children:e.jsxs(J,{defaultValue:"basics",value:d,onValueChange:b,className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(X,{children:[e.jsxs(v,{value:"basics",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),l("Role.Tabs.Basics")]}),s&&e.jsxs(v,{value:"claims",className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),l("Role.Tabs.Claims")]})]}),e.jsx("div",{className:"inline-flex",children:f&&e.jsxs(C,{type:"button",variant:"destructive",onClick:c.openModal,children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),l("Role.Actions.Delete")]})})]}),e.jsx(S,{value:"basics",children:e.jsx(re,{mode:a})}),s&&e.jsx(S,{value:"claims",children:e.jsx(ne,{roleId:s})})]})}),f&&e.jsx(G,{roleId:s,roleName:i.name,isOpen:c.isOpen,setIsOpen:c.setValue,onSuccess:()=>m(D)})]}),p]})};export{Be as R,M as a,we as d};
