import{c as E,B as m,V as K,a6 as P,h as Q,L as w,D as N,x as O,y as _,z}from"./index-DAD0hXUP.js";import{j as e}from"./ui-vendor-BHgw9ghC.js";import{a as S}from"./react-vendor-BOADiDeY.js";import{D as H}from"./DataTable-V4omrcUa.js";import{u as C}from"./useMutation-B7qVQHXu.js";import{u as M}from"./usePaginationTable-CmJzaEWp.js";import{A as B,a as V,b as I,c as R,d as U,e as Z,f as $,g as q}from"./alert-dialog-CIYdOZwQ.js";import{u as G}from"./form-vendor-BmuYqd71.js";import{t as J,F as W}from"./FormRow-BNhhe82P.js";import{d as X,c as Y,S as ee}from"./SecretForm-iXRowA47.js";import{u as y}from"./i18n-vendor-CiQkzSQO.js";import{t as b,c as te}from"./DateTimeHelper-QWEMCMQL.js";import{f as A}from"./utils-zj3SKzMM.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=E("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),ie=({onSubmit:r,onCancel:n,isSubmitting:u})=>{const{t:a}=y(),o=G({defaultValues:X,resolver:J(Y(a)),mode:"onChange"}),i=s=>{s.stopPropagation(),o.handleSubmit(p=>{r(p),K({title:a("Actions.Hooray"),description:a("ClientSecret.Actions.Added")})})(s)};return e.jsx(W,{...o,children:e.jsxs("form",{onSubmit:i,children:[e.jsx(ee,{form:o}),e.jsxs("div",{className:"flex gap-4 justify-end mt-4",children:[e.jsx(m,{type:"button",onClick:n,children:a("Actions.Cancel")}),e.jsx(m,{type:"submit",disabled:u,children:a("Actions.Save")})]})]})})},fe=({resourceId:r,queryKey:n,getSecrets:u,addSecret:a,deleteSecret:o})=>{var j,D;const{t:i}=y(),{pagination:s,setPagination:p}=M(0,5),[v,l]=S.useState(!1),[x,c]=S.useState(null),g=P(),h=Q([...n,s],()=>u(r,s.pageIndex,s.pageSize),{keepPreviousData:!0}),f=C(t=>a(r,t),{onSuccess:()=>{g.invalidateQueries(n),l(!1)}}),L=C(t=>o(t),{onSuccess:()=>{g.invalidateQueries(n)}}),T=t=>{const d=te(t.expiration,t.expirationTime);f.mutate({...t,expiration:t.addExpiration?d:null})},k=[{accessorKey:"type",header:i("Client.Label.SecretType_Label")},{accessorKey:"description",header:i("Client.Label.SecretDescription_Label")},{accessorKey:"expiration",header:i("Client.Label.ClientSecret_ExpirationDate"),cell:({row:t})=>e.jsx("span",{children:t.original.expiration?A(new Date(t.original.expiration),b):null})},{accessorKey:"created",header:i("Client.Label.ClientSecret_Created"),cell:({row:t})=>{var d;return e.jsx("span",{children:A(new Date((d=t.original)==null?void 0:d.created),b)})}},{id:"actions",cell:({row:t})=>e.jsx(m,{onClick:()=>c(t.original),type:"button",variant:"destructive",size:"sm",children:i("Actions.Delete")})}],F=()=>{x&&(L.mutate(x.id),c(null))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:i("Secret.PageTitle")}),e.jsx(m,{type:"button",onClick:()=>l(!0),children:i("Secret.Actions.Add")})]}),h.isLoading?e.jsx(w,{}):e.jsx(H,{columns:k,data:((j=h.data)==null?void 0:j.items)??[],totalCount:((D=h.data)==null?void 0:D.totalCount)??-1,pagination:s,setPagination:p}),e.jsx(N,{open:v,onOpenChange:l,children:e.jsxs(O,{className:"sm:max-w-[800px] overflow-auto max-h-[calc(100vh-2rem)]",children:[e.jsx(_,{children:e.jsx(z,{children:i("Secret.Actions.Add")})}),e.jsx(ie,{onSubmit:T,onCancel:()=>l(!1),isSubmitting:f.isLoading})]})}),e.jsx(B,{open:!!x,onOpenChange:t=>!t&&c(null),children:e.jsxs(V,{children:[e.jsxs(I,{children:[e.jsx(R,{children:i("Actions.ConfirmDeletion")}),e.jsx(U,{children:i("Secret.Actions.DeleteSecretConfirm")})]}),e.jsxs(Z,{children:[e.jsx($,{onClick:()=>c(null),children:i("Actions.Cancel")}),e.jsx(q,{variant:"destructive",onClick:F,children:i("Actions.Delete")})]})]})})]})};export{ge as K,fe as S};
