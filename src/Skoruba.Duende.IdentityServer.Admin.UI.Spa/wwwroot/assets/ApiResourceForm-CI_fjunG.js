import{j as e}from"./ui-vendor-B17-n605.js";import{k as S,L as I,a as w}from"./react-vendor-DPOhIiRq.js";import{u as _}from"./form-vendor-DdiMXTjA.js";import{a,A as D,t as P,F as U}from"./FormRow-BJ2vApYT.js";import{L as h,j as o,S as T,B as R,ab as q,a6 as k,V as B,m as E}from"./index-ho5AqpLY.js";import{u as K}from"./useMutation-BDjjxfIx.js";import{b as F,c as Q,e as W,f as H,h as V,i as z,j as M,k as $,l as G}from"./ApiResourceServices-BvzTdhTB.js";import{T as J,a as O,b as l,c as p}from"./tabs-CtwGsjwO.js";import{C as u}from"./CardWrapper-CUi5pp2C.js";import{c as X,u as Y,p as Z}from"./ClientServices-DO0WL_Uf.js";import{u as m,t as x,T as ee}from"./i18n-vendor-TY_g4tCM.js";import{I as L}from"./info-DpmDjKA8.js";import{K as y,S as se}from"./Secrets-izpEwuYQ.js";import{P as ie}from"./PropertiesApi-DCPHja5T.js";import{T as v}from"./Tip-CScyeZ43.js";import{S as f}from"./shield-DLAkEl2U.js";import{U as re}from"./user-BGrqsieT.js";import{T as ae}from"./trash-2-CicqKZec.js";import{H as te}from"./Hoorey-CUT3sCzh.js";import{b as oe,a as ce}from"./useConfirmUnsavedChanges-CdlA0a9-.js";const ne=()=>{var r;const{t:s}=m(),i=X();return i.isLoading?e.jsx(h,{}):e.jsxs(u,{title:s("ApiResource.Tabs.Basics"),description:s("ApiResource.Tabs.BasicsDescription"),icon:L,children:[e.jsx(a,{name:"name",label:s("ApiResource.Section.Label.Name_Label"),description:s("ApiResource.Section.Label.Name_Info"),type:"input",required:!0}),e.jsx(a,{name:"displayName",label:s("ApiResource.Section.Label.DisplayName_Label"),description:s("ApiResource.Section.Label.DisplayName_Info"),type:"input"}),e.jsx(a,{name:"description",label:s("ApiResource.Section.Label.Description_Label"),description:s("ApiResource.Section.Label.Description_Info"),type:"textarea"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(a,{name:"enabled",label:s("ApiResource.Section.Label.Enabled_Label"),description:s("ApiResource.Section.Label.Enabled_Info"),type:"switch"}),e.jsx(a,{name:"showInDiscoveryDocument",label:s("ApiResource.Section.Label.ShowInDiscoveryDocument_Label"),description:s("ApiResource.Section.Label.ShowInDiscoveryDocument_Info"),type:"switch"}),e.jsx(a,{name:"requireResourceIndicator",label:s("ApiResource.Section.Label.RequireResourceIndicator_Label"),description:s("ApiResource.Section.Label.RequireResourceIndicator_Info"),type:"switch"})]}),e.jsx(a,{name:"allowedAccessTokenSigningAlgorithms",label:s("ApiResource.Section.Label.SigningAlgorithms_Label"),description:s("ApiResource.Section.Label.SigningAlgorithms_Info"),type:"inputWithTable",includeSeparator:!0,inputWithTableSettings:{search:!0,searchDataSource:((r=i.data)==null?void 0:r.map(t=>({id:t.value,name:t.label})))??[]}})]})},le=()=>{const{resourceId:s}=S();return e.jsx(u,{title:x("ApiResource.Tabs.Secrets"),description:x("ApiResource.Tabs.SecretsDescription"),icon:y,children:e.jsx(se,{resourceId:Number(s),queryKey:[o.apiResourceSecrets],getSecrets:W,addSecret:Q,deleteSecret:F})})},pe=()=>{const{resourceId:s}=S();return e.jsx(u,{title:x("ApiResource.Tabs.Properties"),description:x("ApiResource.Tabs.PropertiesDescription"),icon:T,children:e.jsx(ie,{resourceId:Number(s),queryKey:[o.apiResourceProperties,s],pageTitle:"Properties",getProperties:z,addProperty:V,deleteProperty:H})})},ue=()=>{const{t:s}=m(),i=Y(!0,!1);return i.isLoading?e.jsx(h,{}):e.jsxs(u,{title:s("ApiResource.Tabs.Scopes"),description:s("ApiResource.Tabs.ScopesDescription"),icon:f,children:[e.jsxs(v,{children:[s("ApiScope.Tips.NoScope"),e.jsx(R,{variant:"link",size:"sm",className:"h-auto p-0 text-blue-600 underline",asChild:!0,children:e.jsxs(I,{to:q,className:"flex items-center gap-1",target:"_blank",children:[e.jsx(D,{className:"h-3 w-3"}),s("ApiScope.Tips.ApiScope")]})}),"."]}),e.jsx(a,{name:"scopes",label:s("Client.Label.AllowedScopes_Label"),description:s("Client.Label.AllowedScopes_Info"),type:"dualList",dualListSettings:{initialItems:i.data??[]}})]})},me=()=>{var r;const{t:s}=m(),i=Z();return i.isLoading?e.jsx(h,{}):e.jsx(u,{title:s("ApiResource.Tabs.UserClaims"),description:s("ApiResource.Tabs.UserClaimsDescription"),icon:f,children:e.jsx(a,{name:"userClaims",label:s("ApiResource.Section.Label.UserClaims_Label"),description:s("ApiResource.Section.Label.UserClaims_Info"),type:"dualList",dualListSettings:{initialItems:((r=i.data)==null?void 0:r.map(t=>({id:t,label:t})))??[]}})})},de=({onApiResourceDelete:s})=>{const{t:i}=m(),{resourceId:r}=S();return e.jsxs(J,{defaultValue:"basics",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(O,{children:[e.jsxs(l,{value:"basics",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),i("ApiResource.Tabs.Basics")]}),r&&e.jsxs(l,{value:"secrets",className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),i("ApiResource.Tabs.Secrets")]}),e.jsxs(l,{value:"scopes",className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4"}),i("ApiResource.Tabs.Scopes")]}),e.jsxs(l,{value:"userClaims",className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),i("ApiResource.Tabs.UserClaims")]}),r&&e.jsxs(l,{value:"properties",className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),i("ApiResource.Tabs.Properties")]})]}),e.jsx("div",{className:"inline-flex",children:s&&e.jsxs(R,{variant:"destructive",onClick:s,type:"button",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),i("ApiResource.Actions.Delete")]})})]}),e.jsx(p,{value:"basics",children:e.jsx(ne,{})}),e.jsx(p,{value:"secrets",children:e.jsx(le,{})}),e.jsx(p,{value:"properties",children:e.jsx(pe,{})}),e.jsx(p,{value:"scopes",children:e.jsx(ue,{})}),e.jsx(p,{value:"userClaims",children:e.jsx(me,{})})]})};var be=(s=>(s.Create="create",s.Edit="edit",s))(be||{});const qe=({mode:s,resourceId:i,defaultValues:r,onApiResourceDelete:t,setNavigateWithBlocker:j})=>{var g;const{t:c}=m(),d=k(),n=_({resolver:P(M(c)),defaultValues:r}),A=oe(n);w.useEffect(()=>{j&&j(()=>A)},[A,j]);const{DialogCmp:C}=ce(n.formState.isDirty),N=K(b=>s==="create"?$(b):G(Number(i),b),{onSuccess:()=>{d.invalidateQueries(o.apiResource),d.invalidateQueries(o.apiResources),d.invalidateQueries(o.configurationIssues),d.invalidateQueries(o.configurationIssuesSummary),B({title:e.jsx(te,{}),description:c(s==="create"?"ApiResource.Actions.Created":"ApiResource.Actions.Updated")}),A(E)}});return e.jsxs(e.Fragment,{children:[e.jsx(U,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(b=>N.mutate(b)),children:[((g=n.watch("scopes"))==null?void 0:g.length)===0&&e.jsx(v,{className:"mb-4",children:e.jsx(ee,{i18nKey:"ApiResource.Tips.MissingScopes",components:{strong:e.jsx("strong",{})}})}),e.jsx(de,{onApiResourceDelete:t}),e.jsx("div",{className:"flex gap-4 justify-start mt-4",children:e.jsx(R,{type:"submit",children:c(s==="create"?"Actions.Create":"Actions.Save")})})]})}),C]})};export{qe as A,be as a};
