import{j as e}from"./ui-vendor-BHgw9ghC.js";import{a as f}from"./react-vendor-BOADiDeY.js";import{z as g,u as B}from"./form-vendor-BmuYqd71.js";import{a as U,t as Q,F as W}from"./FormRow-BNhhe82P.js";import{c as $,B as j,L as P,V as C,D as J,x as X,y as Y,z as Z,U as K,a6 as ee,o as I,j as F}from"./index-DAD0hXUP.js";import{u as se}from"./useMutation-B7qVQHXu.js";import{u as te,b as ae,c as ie,d as ne,e as le,f as oe,h as re,i as ce,j as de,k as me,l as pe,U as ue,m as be,n as xe}from"./UserDeleteDialog-a0HEFYq0.js";import{t as _,u as D}from"./i18n-vendor-CiQkzSQO.js";import{T as he,a as ge,b as L,c as N}from"./tabs-boYuhYEm.js";import{D as R}from"./DataTable-V4omrcUa.js";import{u as M}from"./usePaginationTable-CmJzaEWp.js";import{u as y}from"./modalHooks-ejr9IXPU.js";import{C as Ue}from"./ClaimsModal-B-mcB61I.js";import{D as v}from"./DeleteDialog-Bik0suhb.js";import{C as k}from"./CardWrapper-DXUMLtvD.js";import{T as E}from"./trash-DKFf5J9F.js";import{T as V}from"./tag-BcCoN8SB.js";import{h as je}from"./RoleService-BxJjPvZp.js";import{S as fe,f as Ce,g as De,h as Se,i as Ae}from"./table-BczK1sh7.js";import{G as H}from"./globe-D1W6Dy3_.js";import{H as Te}from"./Hoorey-C6uL5-tj.js";import{b as Le,a as Ne}from"./useConfirmUnsavedChanges-kJttD3Z5.js";import{I as q}from"./info-DXIB1L4c.js";import{T as ye}from"./trash-2-l37Lmxoo.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=$("KeySquare",[["path",{d:"M12.4 2.7a2.5 2.5 0 0 1 3.4 0l5.5 5.5a2.5 2.5 0 0 1 0 3.4l-3.7 3.7a2.5 2.5 0 0 1-3.4 0L8.7 9.8a2.5 2.5 0 0 1 0-3.4z",key:"165ttr"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"m9.4 10.6-6.814 6.814A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814",key:"1ubxi2"}]]),ve=g.object({userName:g.string().min(1,_("Validation.FieldRequired",{field:_("User.Section.Label.UserUserName_Label")})),email:g.string().email(_("Validation.InvalidEmail")),emailConfirmed:g.boolean().optional(),phoneNumber:g.string().optional(),phoneNumberConfirmed:g.boolean().optional(),lockoutEnabled:g.boolean().optional(),twoFactorEnabled:g.boolean().optional(),accessFailedCount:g.number().optional(),lockoutEndDate:g.date().nullable().optional(),lockoutEndTime:g.string().nullable().optional()}),ns={userName:"",email:"",emailConfirmed:!1,phoneNumber:"",phoneNumberConfirmed:!1,lockoutEnabled:!1,twoFactorEnabled:!1,accessFailedCount:0,lockoutEndDate:null,lockoutEndTime:null},O=({mode:t})=>{const{t:s}=D();return e.jsxs(k,{title:s("User.Tabs.Basics"),description:s("User.Tabs.BasicsDescription"),icon:q,children:[e.jsx(U,{name:"userName",label:s("User.Section.Label.UserUserName_Label"),description:s("User.Section.Label.UserUserName_Info"),type:"input",required:!0}),e.jsxs("div",{className:t===G.Edit?"grid grid-cols-1 md:grid-cols-2 gap-4":"grid grid-cols-1 gap-4",children:[e.jsx(U,{name:"email",label:s("User.Section.Label.UserEmail_Label"),description:s("User.Section.Label.UserEmail_Info"),type:"input",required:!0}),t===G.Edit&&e.jsx(U,{name:"emailConfirmed",label:s("User.Section.Label.UserEmailConfirmed_Label"),description:s("User.Section.Label.UserEmailConfirmed_Info"),type:"switch"})]}),t===G.Edit&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(U,{name:"phoneNumber",label:s("User.Section.Label.UserPhoneNumber_Label"),description:s("User.Section.Label.UserPhoneNumber_Info"),type:"input"}),e.jsx(U,{name:"phoneNumberConfirmed",label:s("User.Section.Label.UserPhoneNumberConfirmed_Label"),description:s("User.Section.Label.UserPhoneNumberConfirmed_Info"),type:"switch"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(U,{name:"lockoutEnabled",label:s("User.Section.Label.UserLockoutEnabled_Label"),description:s("User.Section.Label.UserLockoutEnabled_Info"),type:"switch"}),e.jsx(U,{name:"twoFactorEnabled",label:s("User.Section.Label.UserTwoFactorEnabled_Label"),description:s("User.Section.Label.UserTwoFactorEnabled_Info"),type:"switch"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(U,{name:"accessFailedCount",label:s("User.Section.Label.UserAccessFailedCount_Label"),description:s("User.Section.Label.UserAccessFailedCount_Info"),type:"number",numberSettings:{showFormattedTime:!1}}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(U,{name:"lockoutEndDate",label:s("User.Section.Label.UserLockoutEnd_Label"),description:s("User.Section.Label.UserLockoutEnd_Info"),type:"date",className:"w-1/2"}),e.jsx(U,{name:"lockoutEndTime",label:s("User.Section.Label.UserLockoutEndTime_Label"),description:s("User.Section.Label.UserLockoutEndTime_Info"),type:"time",className:"w-1/2"})]})]})]})]})},Ee=({userId:t})=>{const{t:s}=D(),{pagination:l,setPagination:i}=M(0,5),{isOpen:r,openModal:d,closeModal:n}=y(),[m,a]=f.useState(!1),[c,x]=f.useState(null),{data:o,isLoading:u}=te(t,l.pageIndex,l.pageSize),p=ae(t),A=ie(t),T=h=>{p.mutate(h,{onSuccess:()=>{C({description:s("Claim.Actions.Added"),title:s("Actions.Hooray")}),n()}})},S=h=>{x(h),a(!0)},b=()=>{c!=null&&A.mutate(c,{onSuccess:()=>{C({description:s("Claim.Actions.Deleted"),title:s("Actions.Hooray")}),a(!1),x(null)}})},w=[{accessorKey:"claimType",header:s("Claim.Key")},{accessorKey:"claimValue",header:s("Claim.Value")},{id:"actions",cell:({row:h})=>e.jsx(j,{variant:"ghost",onClick:()=>S(h.original.claimId),className:"text-red-500",children:e.jsx(E,{className:"h-4 w-4"})})}];return u?e.jsx(P,{}):e.jsxs(k,{title:s("User.Tabs.Claims"),description:s("User.Tabs.ClaimsDescription"),icon:V,children:[e.jsx(j,{onClick:d,className:"mb-4",type:"button",children:s("Claim.Actions.Add")}),e.jsx(R,{columns:w,data:(o==null?void 0:o.claims)??[],totalCount:(o==null?void 0:o.totalCount)??0,pagination:l,setPagination:i}),e.jsx(Ue,{isOpen:r,onClose:n,onSubmit:T}),e.jsx(v,{isAlertOpen:m,setIsAlertOpen:a,title:s("Claim.DeleteConfirmTitle"),message:s("Claim.DeleteConfirmDescription"),handleDelete:b})]})},Pe=({isOpen:t,onClose:s,onSubmit:l})=>{const{t:i}=D(),{data:r,isLoading:d}=je(),[n,m]=f.useState(""),a=()=>{n&&l(n),m("")};return d?e.jsx(P,{}):e.jsx(J,{open:t,onOpenChange:s,children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsx(Z,{children:i("Role.Actions.Add")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(fe,{value:n,onValueChange:m,children:[e.jsx(Ce,{children:e.jsx(De,{placeholder:i("Role.Actions.Select")})}),e.jsx(Se,{children:r==null?void 0:r.map(c=>e.jsx(Ae,{value:c.id,children:c.name},c.id))})]}),e.jsx(j,{onClick:a,disabled:!n,children:i("Actions.Add")})]})]})})},ke=({userId:t})=>{const{t:s}=D(),{pagination:l,setPagination:i}=M(0,5),{isOpen:r,openModal:d,closeModal:n}=y(),[m,a]=f.useState(!1),[c,x]=f.useState(null),{data:o,isLoading:u}=ne(t,l.pageIndex,l.pageSize),p=le(t),A=oe(t),T=h=>{p.mutate(h,{onSuccess:()=>{C({title:s("Actions.Hooray"),description:s("Role.Actions.Added")}),n()}})},S=h=>{x(h),a(!0)},b=()=>{c&&A.mutate(c,{onSuccess:()=>{C({title:s("Role.Actions.Deleted")}),a(!1),x(null)}})},w=[{accessorKey:"name",header:s("Role.Section.Label.RoleName_Label")},{id:"actions",cell:({row:h})=>e.jsx(j,{variant:"ghost",onClick:()=>S(h.original.id??""),className:"text-red-500",children:e.jsx(E,{className:"h-4 w-4"})})}];return u?e.jsx(P,{}):e.jsxs(k,{title:s("User.Tabs.Roles"),description:s("User.Tabs.RolesDescription"),icon:K,children:[e.jsx(j,{onClick:d,className:"mb-4",type:"button",children:s("Role.Actions.Add")}),e.jsx(R,{columns:w,data:(o==null?void 0:o.roles)??[],totalCount:(o==null?void 0:o.totalCount)??0,pagination:l,setPagination:i}),e.jsx(Pe,{isOpen:r,onClose:n,onSubmit:T}),e.jsx(v,{isAlertOpen:m,setIsAlertOpen:a,title:s("Role.DeleteConfirmTitle"),message:s("Role.DeleteConfirmDescription"),handleDelete:b})]})},Ge=({userId:t})=>{const{t:s}=D(),[l,i]=f.useState(!1),[r,d]=f.useState(null),{data:n,isLoading:m}=re(t),a=ce(t),c=(u,p)=>{d({loginProvider:u,providerKey:p}),i(!0)},x=()=>{r&&a.mutate(r,{onSuccess:()=>{C({title:s("Actions.Hooray"),description:s("User.Actions.DeleteExternalApplicationDeleted")}),i(!1),d(null)}})},o=[{accessorKey:"providerKey",header:s("User.Section.Label.UserProviderProviderKey_Label")},{accessorKey:"loginProvider",header:s("User.Section.Label.UserProviderProviderDisplayName_Label")},{id:"actions",cell:({row:u})=>e.jsx(j,{variant:"ghost",onClick:()=>c(u.original.loginProvider??"",u.original.providerKey??""),className:"text-red-500",children:e.jsx(E,{className:"h-4 w-4"})})}];return m?e.jsx(P,{}):e.jsxs(k,{title:s("User.Tabs.ExternalApplications"),description:s("User.Tabs.ExternalApplicationsDescription"),icon:H,children:[e.jsx(R,{columns:o,data:n??[],totalCount:(n??[]).length,pagination:{pageIndex:0,pageSize:(n==null?void 0:n.length)??0,hidePagination:!0},setPagination:()=>{}}),e.jsx(v,{isAlertOpen:l,setIsAlertOpen:i,title:s("User.Actions.DeleteExternalApplication"),message:s("User.Actions.DeleteExternalApplicationConfirm"),handleDelete:x})]})},Re=({userId:t})=>{var S;const{t:s}=D(),{pagination:l,setPagination:i}=M(),r=y(),d=y(),[n,m]=f.useState(null),{data:a,isLoading:c}=de(t,l.pageIndex,l.pageSize),x=me(),o=pe(),u=b=>{m(b),r.openModal()},p=()=>{n&&x.mutate(n.key??"",{onSuccess:()=>{C({title:s("Actions.Hooray"),description:s("User.PersistedGrants.Deleted")}),r.closeModal(),m(null)}})},A=()=>{o.mutate(t,{onSuccess:()=>{C({title:s("Actions.Hooray"),description:s("User.PersistedGrants.DeletedAll")}),d.closeModal()}})},T=[{accessorKey:"type",header:s("User.PersistedGrants.Type")},{accessorKey:"clientId",header:s("User.PersistedGrants.ClientId")},{accessorKey:"creationTime",header:s("User.PersistedGrants.CreationTime"),cell:({row:b})=>b.original.creationTime?new Date(b.original.creationTime).toLocaleString():"-"},{accessorKey:"expiration",header:s("User.PersistedGrants.Expiration"),cell:({row:b})=>b.original.expiration?new Date(b.original.expiration).toLocaleString():"-"},{id:"actions",cell:({row:b})=>e.jsx(j,{type:"button",variant:"ghost",onClick:()=>u(b.original),className:"text-red-500",title:s("Actions.Delete"),children:e.jsx(E,{className:"h-4 w-4"})})}];return c?e.jsx(P,{}):e.jsxs(k,{title:s("User.Tabs.PersistedGrants"),description:s("User.Tabs.PersistedGrantsDescription"),icon:z,children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(j,{type:"button",variant:"destructive",onClick:d.openModal,disabled:(((S=a==null?void 0:a.persistedGrants)==null?void 0:S.length)??0)===0,children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),s("User.PersistedGrants.DeleteAllGrants")]})}),e.jsx(R,{columns:T,data:(a==null?void 0:a.persistedGrants)??[],totalCount:(a==null?void 0:a.totalCount)??0,pagination:l,setPagination:i}),e.jsx(v,{isAlertOpen:r.isOpen,setIsAlertOpen:r.setValue,title:s("User.PersistedGrants.DeleteGrantTitle"),message:s("User.PersistedGrants.DeleteGrantConfirm"),handleDelete:p}),e.jsx(v,{isAlertOpen:d.isOpen,setIsAlertOpen:d.setValue,title:s("User.PersistedGrants.DeleteAllTitle"),message:s("User.PersistedGrants.DeleteAllConfirm"),handleDelete:A})]})};var G=(t=>(t.Create="create",t.Edit="edit",t))(G||{});const ls=({mode:t,userId:s,defaultValues:l})=>{const{t:i}=D(),r=ee(),[d,n]=f.useState("basics"),m=y(),a=B({resolver:Q(ve),defaultValues:l}),c=Le(a),{DialogCmp:x}=Ne(a.formState.isDirty),o=se(p=>t==="create"?be(p):xe(s,p),{onSuccess:()=>{r.invalidateQueries(F.users),r.invalidateQueries(F.user),c(I),C({title:e.jsx(Te,{}),description:i(t==="create"?"User.Actions.Created":"User.Actions.Updated")})}}),u=t==="edit"&&!!s&&!!l.userName;return e.jsxs(e.Fragment,{children:[e.jsxs(W,{...a,children:[e.jsxs("form",{onSubmit:a.handleSubmit(p=>o.mutate(p)),children:[s&&t==="edit"?e.jsxs(he,{defaultValue:"basics",onValueChange:p=>n(p),className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(ge,{children:[e.jsxs(L,{value:"basics",className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),i("User.Tabs.Basics")]}),e.jsxs(L,{value:"claims",className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),i("User.Tabs.Claims")]}),e.jsxs(L,{value:"roles",className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),i("User.Tabs.Roles")]}),e.jsxs(L,{value:"providers",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),i("User.Tabs.ExternalApplications")]}),e.jsxs(L,{value:"persistedgrants",className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),i("User.Tabs.PersistedGrants")]})]}),e.jsx("div",{className:"inline-flex",children:u&&e.jsxs(j,{type:"button",variant:"destructive",onClick:m.openModal,children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),i("User.Actions.Delete")]})})]}),e.jsx(N,{value:"basics",children:e.jsx(O,{mode:t})}),e.jsx(N,{value:"claims",children:e.jsx(Ee,{userId:s})}),e.jsx(N,{value:"roles",children:e.jsx(ke,{userId:s})}),e.jsx(N,{value:"providers",children:e.jsx(Ge,{userId:s})}),e.jsx(N,{value:"persistedgrants",children:e.jsx(Re,{userId:s})})]}):e.jsx(O,{mode:t}),d==="basics"&&e.jsx("div",{className:"flex gap-4 justify-start mt-4",children:e.jsx(j,{type:"submit",children:i(t==="create"?"Actions.Create":"Actions.Save")})})]}),u&&e.jsx(ue,{userId:s,userName:l.userName,isOpen:m.isOpen,setIsOpen:m.setValue,onSuccess:()=>c(I)})]}),x]})};export{ls as U,G as a,ns as d};
