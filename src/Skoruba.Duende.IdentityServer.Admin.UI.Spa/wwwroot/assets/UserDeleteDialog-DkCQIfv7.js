import{j as p}from"./ui-vendor-B17-n605.js";import{D}from"./DeleteDialog-DxTJNNnN.js";import{u as f,a6 as u,j as o,aw as i,ax as A,ad as a,ay as w,az as g,aA as k,aB as y,aC as v,V as N}from"./index-IoJ-2H-o.js";import{u as l}from"./useMutation-Cp5GjrFm.js";import{a as b,b as G}from"./DateTimeHelper-8fem5lKY.js";import{H as h}from"./Hoorey-DuQ14gon.js";import{u as P,T as F}from"./i18n-vendor-TY_g4tCM.js";const c=()=>new i(a.getApiBaseUrl()),U=()=>new k(a.getApiBaseUrl()),O=(e,s=0,t=10)=>f([o.userRoles,e,s,t],async()=>{const n=await c().getUserRoles(e,s,t);return{roles:n.roles??[],totalCount:n.totalCount??0}},{enabled:!!e,keepPreviousData:!0}),K=e=>{const s=u();return l(async t=>await new i(a.getApiBaseUrl()).postUserRoles(new w({userId:e,roleId:t})),{onSuccess:()=>{s.invalidateQueries([o.userRoles,e])}})},V=e=>{const s=u();return l(async t=>await new i(a.getApiBaseUrl()).deleteUserRoles(new w({userId:e,roleId:t})),{onSuccess:()=>{s.invalidateQueries([o.userRoles,e])}})},M=(e,s,t)=>f([o.userClaims,e,s,t],async()=>await c().getUserClaims(e,s+1,t)),J=e=>{const s=u();return l(async({key:t,value:r})=>{const n=c(),m=new A({claimId:0,userId:e,claimType:t,claimValue:r});return await n.postUserClaims(m)},{onSuccess:()=>{s.invalidateQueries([o.userClaims,e])}})},L=e=>{const s=u();return l(async t=>await c().deleteUserClaims(e,t),{onSuccess:()=>{s.invalidateQueries([o.userClaims,e])}})},W=async(e,s,t)=>{var d;const n=await new i(a.getApiBaseUrl()).get2(e,s+1,t);return{items:((d=n.users)==null?void 0:d.map(C=>({id:C.id,userName:C.userName,email:C.email})))??[],totalCount:n.totalCount??0}},X=async e=>{const t=await new i(a.getApiBaseUrl()).get(e),{date:r,time:n}=G(t.lockoutEnd);return{userName:t.userName,email:t.email,emailConfirmed:t.emailConfirmed??!1,phoneNumber:t.phoneNumber??"",phoneNumberConfirmed:t.phoneNumberConfirmed??!1,lockoutEnabled:t.lockoutEnabled??!1,twoFactorEnabled:t.twoFactorEnabled??!1,accessFailedCount:t.accessFailedCount??0,lockoutEndDate:r,lockoutEndTime:n}},Y=async e=>{const s=new i(a.getApiBaseUrl()),t=b(e.lockoutEndDate,e.lockoutEndTime);await s.post(new y({id:void 0,userName:e.userName,email:e.email,lockoutEnd:t===null?void 0:t,emailConfirmed:e.emailConfirmed??!1,phoneNumber:e.phoneNumber??void 0,phoneNumberConfirmed:e.phoneNumberConfirmed??!1,lockoutEnabled:e.lockoutEnabled??!1,twoFactorEnabled:e.twoFactorEnabled??!1,accessFailedCount:e.accessFailedCount??0}))},Z=async(e,s)=>{const t=new i(a.getApiBaseUrl()),r=b(s.lockoutEndDate,s.lockoutEndTime);await t.put(new y({...s,id:e,lockoutEnd:r===null?void 0:r,emailConfirmed:s.emailConfirmed??!1,phoneNumber:s.phoneNumber??void 0,phoneNumberConfirmed:s.phoneNumberConfirmed??!1,lockoutEnabled:s.lockoutEnabled??!1,twoFactorEnabled:s.twoFactorEnabled??!1,accessFailedCount:s.accessFailedCount??0}))},B=async e=>{await new i(a.getApiBaseUrl()).delete(e)},_=e=>f([o.userExternalApps,e],async()=>(await c().getUserProviders(e)).providers??[]),$=e=>l(async({loginProvider:s,providerKey:t})=>{const r=c(),n=new g({userId:e,providerKey:t,loginProvider:s});await r.deleteUserProviders(n)}),z=(e,s,t)=>f([o.userPersistedGrants,e,s,t],async()=>{const r=U();try{const n=await r.getBySubject(e,s+1,t);return{persistedGrants:n.persistedGrants??[],totalCount:n.totalCount??0}}catch(n){if(n instanceof v&&n.status===400)return{persistedGrants:[],totalCount:0};throw n}},{keepPreviousData:!0}),R=async e=>{await U().delete(e)},I=()=>{const e=u();return l(async s=>{await R(s)},{onSuccess:()=>{e.invalidateQueries(o.userPersistedGrants)}})},ee=()=>{const e=u();return l(async s=>{await U().deleteBySubject(s)},{onSuccess:()=>{e.invalidateQueries(o.userPersistedGrants)}})},se=({userId:e,userName:s,isOpen:t,setIsOpen:r,onSuccess:n})=>{const{t:m}=P(),d=u(),C=l(()=>B(e),{onSuccess:()=>{d.invalidateQueries(o.users),N({title:p.jsx(h,{}),description:m("User.Actions.Deleted")}),r(!1),n==null||n()},onError:()=>{r(!1)}}),E=()=>{C.mutate()};return p.jsx(D,{isAlertOpen:t,setIsAlertOpen:r,title:m("User.Actions.DeleteConfirmTitle"),message:p.jsx(F,{i18nKey:"User.Actions.DeleteConfirmDescription",values:{userName:s},components:{strong:p.jsx("strong",{className:"text-destructive"})}}),handleDelete:E})};export{se as U,X as a,J as b,L as c,O as d,K as e,V as f,W as g,_ as h,$ as i,z as j,I as k,ee as l,Y as m,Z as n,M as u};
