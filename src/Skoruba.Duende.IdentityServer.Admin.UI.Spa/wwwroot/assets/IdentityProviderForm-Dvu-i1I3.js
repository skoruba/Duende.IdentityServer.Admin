import{j as e}from"./ui-vendor-B17-n605.js";import{z as i,u as C}from"./form-vendor-DdiMXTjA.js";import{a as d,t as F,F as D}from"./FormRow-DmA7DEgi.js";import{S as x,B as y,p as v,V as _,aG as q}from"./index-X8931wOL.js";import{b as w,c as B,I as V}from"./IdentityProviderDeleteDialog-DFpe_EVd.js";import{H as A}from"./Hoorey-xTWvU1SQ.js";import{u as R}from"./modalHooks-CXBaxWb4.js";import{C as h}from"./CardWrapper-BWyRWD8Q.js";import{u as m,t as r}from"./i18n-vendor-TY_g4tCM.js";import{I as j}from"./info-Dtgl6j4a.js";import{P as E}from"./PropertiesForm-CTNvZIHJ.js";import{T as P,a as U,b as I,c as f}from"./tabs-DiTC9L03.js";import{a as M}from"./react-vendor-DPOhIiRq.js";import{b as k,a as O}from"./useConfirmUnsavedChanges-CFlu1bHi.js";import{T as H}from"./trash-2-DeOtqpFP.js";const W=()=>{const{t}=m();return e.jsxs(h,{title:t("IdentityProvider.Tabs.Basics"),description:t("IdentityProvider.Tabs.BasicsDescription"),icon:j,children:[e.jsx(d,{name:"scheme",label:t("IdentityProvider.Section.Label.Scheme_Label"),description:t("IdentityProvider.Section.Label.Scheme_Info"),type:"input",required:!0}),e.jsx(d,{name:"type",label:t("IdentityProvider.Section.Label.ProtocolType_Label"),description:t("IdentityProvider.Section.Label.ProtocolType_Info"),type:"input",required:!0}),e.jsx(d,{name:"displayName",label:t("IdentityProvider.Section.Label.DisplayName_Label"),description:t("IdentityProvider.Section.Label.DisplayName_Info"),type:"input",required:!0}),e.jsx(d,{name:"enabled",label:t("IdentityProvider.Section.Label.Enabled_Label"),description:t("IdentityProvider.Section.Label.Enabled_Info"),type:"switch"})]})},z=()=>e.jsx(W,{}),G=()=>{const{t}=m();return e.jsx(h,{title:t("IdentityProvider.Tabs.Properties"),description:t("IdentityProvider.Tabs.PropertiesDescription"),icon:x,children:e.jsx(E,{})})},K=i.object({id:i.number().optional().default(0),scheme:i.string().min(1,r("Validation.FieldRequired",{field:r("IdentityProvider.Section.Label.Scheme_Label")})),displayName:i.string().min(1,r("Validation.FieldRequired",{field:r("IdentityProvider.Section.Label.DisplayName_Label")})),enabled:i.boolean(),type:i.string().min(1,r("Validation.FieldRequired",{field:r("IdentityProvider.Section.Label.ProtocolType_Label")})),properties:i.array(i.object({id:i.number().optional().default(0),key:i.string().min(1,r("Validation.FieldRequired",{field:r("Property.Key")})),value:i.string().min(1,r("Validation.FieldRequired",{field:r("Property.Value")}))})).default([])}),me={id:0,scheme:"",displayName:"",enabled:!0,type:"oidc",properties:[]};var $=(t=>(t.Create="create",t.Edit="edit",t))($||{});const pe=({mode:t,defaultValues:a})=>{const{t:s}=m(),l=R(),[p,b]=M.useState("basics"),o=C({resolver:F(K),defaultValues:a}),c=k(o),{DialogCmp:S}=O(o.formState.isDirty),T=w(),g=B(),L=async N=>{const n=await(t==="create"?T:g).mutateAsync(N);_({title:e.jsx(A,{}),description:s(t==="create"?"IdentityProvider.Actions.Created":"IdentityProvider.Actions.Updated")}),t==="create"&&(n!=null&&n.id)?c(q.replace(":providerId",n.id.toString())):c(v)},u=t==="edit"&&!!a.id&&!!a.scheme;return e.jsxs(e.Fragment,{children:[e.jsxs(D,{...o,children:[e.jsxs("form",{onSubmit:o.handleSubmit(L),children:[e.jsxs("div",{className:"flex items-center justify-between mt-4 mb-4",children:[e.jsx(P,{defaultValue:"basics",value:p,onValueChange:b,className:"flex-1",children:e.jsxs(U,{children:[e.jsxs(I,{value:"basics",className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4"}),s("IdentityProvider.Tabs.Basics")]}),e.jsxs(I,{value:"properties",className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),s("IdentityProvider.Tabs.Properties")]})]})}),u&&e.jsxs(y,{type:"button",variant:"destructive",onClick:l.openModal,className:"ml-4",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),s("IdentityProvider.Actions.Delete")]})]}),e.jsxs(P,{defaultValue:"basics",value:p,onValueChange:b,className:"mt-0",children:[e.jsx(f,{value:"basics",children:e.jsx(z,{})}),e.jsx(f,{value:"properties",children:e.jsx(G,{})})]}),e.jsx("div",{className:"flex gap-4 justify-start mt-4",children:e.jsx(y,{type:"submit",children:s(t==="create"?"Actions.Create":"Actions.Save")})})]}),u&&e.jsx(V,{providerId:a.id.toString(),identityProviderName:a.scheme,isOpen:l.isOpen,setIsOpen:l.setValue,onSuccess:()=>c(v)})]}),S]})};export{pe as I,$ as a,me as d};
